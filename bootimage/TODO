$Id: TODO,v 1.16 2004/07/04 16:23:44 fare Exp $ -*- Fundamental -*-

Kernel 2.4
* move on, dude!
* maybe fix issues (that may reappear in 2.6?):
 * the APM kill-the-machine-if-kapmd-killed bug if still present

Kernel 2.6
* port the keyboard driver
* ensure the mouse driver works
* port the sa1101 driver
* port and fix the PCMCIA driver
* make the USB driver work
* port and fix the apm driver
* add sleep/wakeup functions to all our drivers, so as to support swsusp.
* make the sound driver work
* ensure that backlight control works on fb
* get external VGA working and/or some swap-on-VRAM
* get modem working?
* get some spiffy 802.11g card working!
* play nicer with booting to/from WinCE

Bootdisk
* have pcmcia and busybox from CVS.
* include kernel 2.6 module support in busybox configuration.
* ensure busybox sh correctly reads /etc/profile at startup.
* make the initrd work with udev ???
* use early-userspace on kernel 2.6 ???

Userland
* gather a sensible base for userland (?)
* maybe based on OE? on uwoody?
* get a small distribution that includes xemacs and some extensions

Web site
* have a cron job update the web site from CVS.

Bootloader
* build a gcc toolchain for arm-wince-pe ???
* we imported the linexec source code as j820boot,
 now port it to gcc and some gnu libraries.

------>8------>8------>8------>8------>8------>8------>8------>8------>8------
apm: do something
2.4 => kernel/arch/arm/mach-sa1100/apm.c
2.6 => kernel/arch/arm/mach-sa1100/jornada820.c
   kernel/arch/arm/kernel/apm.c
new apm_power_info structure

--- arch/arm/mach-sa1100/apm.c  22 Feb 2004 03:41:28 -0000
   1.1.1.1
+++ arch/arm/mach-sa1100/apm.c  4 Mar 2004 08:45:07 -0000       1.2
@@ -168,6 +168,9 @@
 #ifdef CONFIG_IPAQ_HANDHELD
             h3600_apm_get_power_status(ac_line_status,
   battery_status, battery_
flag, battery_percentage, battery_life);
 #endif
+#ifdef CONFIG_SA1100_JORNADA820
+            j820_apm_get_power_status(ac_line_status, battery_status,
   battery_f
lag, battery_percentage, battery_life);
+#endif
        return APM_SUCCESS;
 }

------>8------>8------>8------>8------>8------>8------>8------>8------>8------
video/sa1100fb.c

ensure that somewhere in
extern void (*sa1100fb_backlight_power)(int on);
there is

#ifdef CONFIG_SA1100_JORNADA820
        GPSR = GPIO_JORNADA820_BACKLIGHTON;
#endif

------>8------>8------>8------>8------>8------>8------>8------>8------>8------
arch/arm/common/sa1101.c
 understand why the mouse generates an uncaught sa1101 interrupt for
 every few bytes read. These were silent in 2.4 (but present,
 incrementing the interrupt counter), but generate messages in 2.6.

 Maybe the sa1101ps2.c doesn't send bytes correctly?
 Or maybe the trackpad just doesn't reply?

------>8------>8------>8------>8------>8------>8------>8------>8------>8------
pcmcia:
* understand why we don't get events when cards are inserted, only when
 they are ejected.
 Hypothesis: we are mishandling an initial event and the controller is
 stuck waiting for our proper handling.

* while migrating to the driver model, I broke the way
 that the driver is initialized at all! Fix that.

------>8------>8------>8------>8------>8------>8------>8------>8------>8------
j820_keyb.c:

 Maybe special-case the Alt+arrow = PgUp, PgDn, Beg, End mappings? (?)
 Maybe special-case the On/Off key (?)
 Have a SysRQ button.
 Recognize as such the special button on the back?

------>8------>8------>8------>8------>8------>8------>8------>8------>8------
usb:

 try it? forward-port the changes by Matan?
------>8------>8------>8------>8------>8------>8------>8------>8------>8------
